<?php

class exploitsform extends tpl_form {
  var $table = "exploits";
  var $key = "id";
  var $key_field = "id"; # if different to $key
  var $classname = "exploitsform";
  var $database_class = "DB_probind";

  function setup_fields () {
    $this->form_data->add_element(array("type"=>"hidden","name"=>"id","field"=>"id","size"=>"12"));
    $this->form_data->add_element(array("type"=>"text","name"=>"ip","maxlength"=>"40","size"=>"13"
		,"minlength"=>1,"length_e"=>"Ip must not be blank.  Required field.",
		"field"=>"ip","extrahtml"=>""
		));
    $this->form_data->add_element(array("type"=>"text","name"=>"mac","maxlength"=>"20","size"=>"6"
		,"minlength"=>1,"length_e"=>"Mac must not be blank.  Required field.",
		"field"=>"mac","extrahtml"=>""
		));
    $this->form_data->add_element(array("type"=>"text","name"=>"nas_id","size"=>"12",
		"valid_regex"=>"^[0-9|\-]+$","field"=>"nas_id",
		"valid_e"=>"Nas must be a whole number containing digits 0-9 only. May also start with negative symbol -",
		"extrahtml"=>""));
    $this->form_data->add_element(array("type"=>"text","name"=>"UserName","maxlength"=>"60","size"=>"20"
		,"minlength"=>1,"length_e"=>"User Name must not be blank.  Required field.",
		"field"=>"UserName","extrahtml"=>""
		));
    $this->form_data->add_element(array("type"=>"textarea","name"=>"string","rows"=>"5","cols"=>"50",
		"field"=>"string","extrahtml"=>""));
    $this->form_data->add_element(array("type"=>"textarea","name"=>"violation","rows"=>"5","cols"=>"50",
		"field"=>"violation","extrahtml"=>""));
    $this->form_data->add_element(array("type"=>"textarea","name"=>"target","rows"=>"5","cols"=>"50",
		"field"=>"target","extrahtml"=>""));
    $this->form_data->add_element(array("type"=>"text","name"=>"banned","size"=>"12",
		"valid_regex"=>"^[0-9|\-]+$","field"=>"banned",
		"valid_e"=>"Banned must be a whole number containing digits 0-9 only. May also start with negative symbol -",
		"extrahtml"=>""));
    $this->form_data->add_element(array("type"=>"date","name"=>"datetime","maxlength"=>"","size"=>"0"
		,"minlength"=>1,"length_e"=>"Datetime must not be blank.  Required field.",
		"field"=>"datetime","extrahtml"=>" onBlur=\"ajax_update_element(this,'find.php?dt=')\""
		,"valid_e"=>"Invalid Date","valid_regex"=>"datetime"));
    $this->form_data->add_element(array("type"=>"submit","name"=>"submit","value"=>"Submit"));
  }

}
class exploitsTable extends Table {
  var $classname = "exploitsTable";
  var $sql_table = "exploits";
  var $primary_key = "id";
  var $primary_field = "id";
  var $all_fields = array(
			"ip",
			"UserName",
			"string",
			"violation",
			"target",
			"banned",
			"datetime",
			"mac",
			"nas_id",
			);

  /* comment out or delete some of these default entries so that the table isn't too wide for the screen */
  var $default = array(
			"ip",
			"UserName",
			"violation",
			"banned",
			"datetime",
			"target",
			"string",
			);

  // These fields will be searchable and displayed in results.
  // Format is "RealFieldName"=>"Field Name Formatted For Display",
  var $map_cols = array(
			"ip"=>"IP Address",
			"mac"=>"MAC Address",
			"nas_id"=>"Nas",
			"UserName"=>"User Name",
			"string"=>"String",
			"violation"=>"Violation",
			"target"=>"Target",
			"banned"=>"Banned",
			"datetime"=>"Datetime");
}
class exploits_Sql_Query extends Sql_Query {
  var $classname = "exploits_Sql_Query";
  var $primary_key = "id";
  var $primary_field = "id";
  var $table = "exploits";
}

